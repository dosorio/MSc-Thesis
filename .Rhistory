runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])
V <- sapply(seq_len(model@react_num), function(x){runif(n = FVA@react@react_num,min = FVA@lp_obj[x],max = FVA@lp_obj[(model@react_num+x)])})
warnings
View(V)
dim(V)
is.na(V)
table(is.na(V))
colSums(is.na(V))
which.max(colSums(is.na(V)))
x=52
FVA@lp_obj[x]
FVA@lp_obj[(model@react_num+x)]
V <- sapply(seq_len(model@react_num), function(x){runif(n = FVA@react@react_num,min = min(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])),max = max(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])) )})
diag(V) <- getFluxDist(optimizeProb(model))
OF <- function(w){
f <- mapply(function(x,y){V[x,y]},x=w,y=seq_len(model@react_num))
model@lowbnd <- f
model@uppbnd <- f
optimizeProb(model)@lp_obj
}
b <- unlist(foreach(i=1:R) %dopar% {
OF(sample(seq_len(model@react_num)))
})
b
sd(b)()
sd(b)
sd(b)
R = 10
t0 <- optimizeProb(model)@lp_obj
set.seed(1234)
FVA <- fluxVar(model)
V <- sapply(seq_len(model@react_num), function(x){runif(n = FVA@react@react_num,min = min(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])),max = max(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])) )})
diag(V) <- getFluxDist(optimizeProb(model))
OF <- function(w){
f <- mapply(function(x,y){V[x,y]},x=w,y=seq_len(model@react_num))
model@lowbnd <- f
model@uppbnd <- f
optimizeProb(model)@lp_obj
}
b <- unlist(foreach(i=1:R) %dopar% {
OF(sample(seq_len(model@react_num)))
})
sd(b)
sort(b)
hist(sort(b))
pM <- function(model,R){
t0 <- optimizeProb(model)@lp_obj
set.seed(1234)
FVA <- fluxVar(model)
V <- sapply(seq_len(model@react_num), function(x){runif(n = FVA@react@react_num,min = min(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])),max = max(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])) )})
diag(V) <- getFluxDist(optimizeProb(model))
OF <- function(w){
f <- mapply(function(x,y){V[x,y]},x=w,y=seq_len(model@react_num))
model@lowbnd <- f
model@uppbnd <- f
optimizeProb(model)@lp_obj
}
b <- unlist(foreach(i=1:R) %dopar% {
OF(sample(seq_len(model@react_num)))
})
return(mean(b<=t0))
}
pM(model,100)
b<t0
b>t0
pM <- function(model,R){
t0 <- optimizeProb(model)@lp_obj
set.seed(1234)
FVA <- fluxVar(model)
V <- sapply(seq_len(model@react_num), function(x){runif(n = FVA@react@react_num,min = min(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])),max = max(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])) )})
diag(V) <- getFluxDist(optimizeProb(model))
OF <- function(w){
f <- mapply(function(x,y){V[x,y]},x=w,y=seq_len(model@react_num))
model@lowbnd <- f
model@uppbnd <- f
optimizeProb(model)@lp_obj
}
b <- unlist(foreach(i=1:R) %dopar% {
OF(sample(seq_len(model@react_num)))
})
return(mean(b>=t0))
}
pM(model,100)
b <- unlist(foreach(i=1:R) %dopar% {
OF(sample(seq_len(model@react_num)))
})
quantile(b,c(0.025,0,095))
quantile(b,c(0.025,0.095))
quantile(b,c(0.025,0.95))
quantile(b,c(0.05,0.95))
quantile(b,c(0.025,0.975))
sdM <- function(model,R){
t0 <- optimizeProb(model)@lp_obj
set.seed(1234)
FVA <- fluxVar(model)
V <- sapply(seq_len(model@react_num), function(x){runif(n = FVA@react@react_num,min = min(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])),max = max(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])) )})
diag(V) <- getFluxDist(optimizeProb(model))
OF <- function(w){
f <- mapply(function(x,y){V[x,y]},x=w,y=seq_len(model@react_num))
model@lowbnd <- f
model@uppbnd <- f
optimizeProb(model)@lp_obj
}
b <- unlist(foreach(i=1:R) %dopar% {
OF(sample(seq_len(model@react_num)))
})
return(sd(b))
}
sdM(model,100)
sdM(model,1000)
biib
mean(b)
mean(b)-b
mean(mean(b)-b)
mean(mean(b)-b)^2
sdM <- function(model,R){
t0 <- optimizeProb(model)@lp_obj
set.seed(1234)
FVA <- fluxVar(model)
V <- sapply(seq_len(model@react_num), function(x){runif(n = FVA@react@react_num,min = min(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])),max = max(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])) )})
diag(V) <- getFluxDist(optimizeProb(model))
OF <- function(w){
f <- mapply(function(x,y){V[x,y]},x=w,y=seq_len(model@react_num))
model@lowbnd <- f
model@uppbnd <- f
optimizeProb(model)@lp_obj
}
b <- unlist(foreach(i=1:R) %dopar% {
OF(sample(seq_len(model@react_num)))
})
return(c(BIAS=mean(mean(b)-b)^2,SD=sd(b)))
}
sdM(model,1000)
data("Ec_core")
sdM(Ec_core,1000)
V <- function(model,R){
t0 <- optimizeProb(model)@lp_obj
set.seed(1234)
FVA <- fluxVar(model)
V <- sapply(seq_len(model@react_num), function(x){runif(n = FVA@react@react_num,min = min(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])),max = max(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])) )})
diag(V) <- getFluxDist(optimizeProb(model))
OF <- function(w){
f <- mapply(function(x,y){V[x,y]},x=w,y=seq_len(model@react_num))
model@lowbnd <- f
model@uppbnd <- f
optimizeProb(model)@lp_obj
}
b <- unlist(foreach(i=1:R) %dopar% {
OF(sample(seq_len(model@react_num)))
})
}
O1 <- V(model1,R)
model1 <- Ec_core
model2 <- Ec_core
O1 <- V(model1,R)
O2 <- V(model2,R)
t.test(O1,O2)
t.test(O1,O2)
tM <- function(model1,model2,R){
V <- function(model,R){
t0 <- optimizeProb(model)@lp_obj
set.seed(1234)
FVA <- fluxVar(model)
V <- sapply(seq_len(model@react_num), function(x){runif(n = FVA@react@react_num,min = min(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])),max = max(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])) )})
diag(V) <- getFluxDist(optimizeProb(model))
OF <- function(w){
f <- mapply(function(x,y){V[x,y]},x=w,y=seq_len(model@react_num))
model@lowbnd <- f
model@uppbnd <- f
optimizeProb(model)@lp_obj
}
b <- unlist(foreach(i=1:R) %dopar% {
OF(sample(seq_len(model@react_num)))
})
}
M1 <- V(model1,R)
M2 <- V(model2,R)
t.test(O1,O2)
}
healthy <- readSBMLmod("Documents/masterThesis/Results/matureAstrocyte.xml")
inflammated <- healthy
lowbnd(inflammated)
uppbnd(inflammated)[inflammated@react_id=="EX_hdca(e)"] <- -0.208
tM(healthy,inflammated,1000)
tM <- function(model1,model2,R){
V <- function(model,R){
t0 <- optimizeProb(model)@lp_obj
set.seed(1234)
FVA <- fluxVar(model)
V <- sapply(seq_len(model@react_num), function(x){runif(n = FVA@react@react_num,min = min(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])),max = max(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])) )})
diag(V) <- getFluxDist(optimizeProb(model))
OF <- function(w){
f <- mapply(function(x,y){V[x,y]},x=w,y=seq_len(model@react_num))
model@lowbnd <- f
model@uppbnd <- f
optimizeProb(model)@lp_obj
}
b <- unlist(foreach(i=1:R) %dopar% {
OF(sample(seq_len(model@react_num)))
})
}
M1 <- V(model1,R)
M2 <- V(model2,R)
t.test(M1,M2)
}
tM(healthy,inflammated,1000)
citation("sybil")
citation(minval)
citation("minval")
citation("R")
citation(R)
citation()
citation("exp2flux")
cite("glpkapi")
cite("glpkAPI")
citation("glpkAPI")
?RobAna
library(sybil)
?robAna
scan("Desktop/Taller3.tsv")
v <- scan("Desktop/Taller3.tsv")
sum(round(v,2))
mean(v)
median(v)
TiboloneReactions <- read.csv("~/Documents/masterThesis/Results/TiboloneReactions.csv", sep=";")
View(TiboloneReactions)
TiboloneReactions <- read.csv("~/Documents/masterThesis/Results/TiboloneReactions.csv", sep=";")
View(TiboloneReactions)
View(TiboloneReactions)
RECON_met <- read.delim("~/Dropbox/Maestria Bioinformatica/Tesis de Maestria/Data/RECON_met.txt")
View(RECON_met)
runif(n = 4,min = 1,max = 10)
round(runif(n = 4,min = 1,max = 10))
round(runif(n = 4,min = 1,max = 10))
write.table(round(runif(n = 4,min = 1,max = 10)),quote = FALSE)
write.table(round(runif(n = 4,min = 1,max = 10)),quote = FALSE,row.names = FALSE,col.names = FALSE,sep = "\t")
write.table(round(runif(n = 4,min = 1,max = 10)),quote = FALSE,row.names = FALSE,col.names = FALSE,sep = "\t",file = "Taller3.tsv")
write.table(round(runif(n = 4,min = 1,max = 10)),quote = FALSE,row.names = FALSE,col.names = FALSE,sep = "\t",file = "Desktop/Taller3.tsv")
write.table(round(runif(n = 4,min = 1,max = 10)),quote = FALSE,row.names = FALSE,col.names = FALSE,eol = "\t",file = "Desktop/Taller3.tsv")
write.table(runif(n = 4,min = 1,max = 10),quote = FALSE,row.names = FALSE,col.names = FALSE,eol = "\t",file = "Desktop/Taller3.tsv")
write.table(round(runif(n = 9,min = 1,max = 10)),quote = FALSE,row.names = FALSE,col.names = FALSE,eol = "\t",file = "Desktop/Taller3.tsv")
write.table(round(runif(n = 16,min = 1,max = 10)),quote = FALSE,row.names = FALSE,col.names = FALSE,eol = "\t",file = "Desktop/Taller3.tsv")
write.table(round(runif(n = 16,min = 1,max = 10)),quote = FALSE,row.names = FALSE,col.names = FALSE,eol = "\t",file = "Desktop/Taller3.tsv")
scan("Desktop/Taller3.tsv")
n <- scan("Desktop/Taller3.tsv")
sum(n)
round(n,2)
sum(round(n,2))
mean(n)
median(n)
m <- read.csv2("Desktop/Apellido1Apellido2_1.txt")
View(m)
Apellido1Apellido2_1 <- read.csv("~/Desktop/Apellido1Apellido2_1.txt", header=FALSE, sep=";")
View(Apellido1Apellido2_1)
View(Apellido1Apellido2_1)
AGenes <- read.csv("~/Desktop/AGenes.txt", sep="")
View(AGenes)
setwd("~/Documents/masterThesis")
library(exp2flux)
library(gage)
library(gridExtra)
library(minval)
library(sybilSBML)
library(lattice)
Astrocyte <- read.csv2("Results/Astrocyte.csv")
length(grep("EX_",Astrocyte$ID))
table(Astrocyte$GPR[lengths(sapply(Astrocyte$REACTION[!grepl("EX_",Astrocyte$ID)], compartments))>1]!="")
RXN <- AGenes[AGenes$ENTREZ_GENE%in%unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR[lengths(sapply(Astrocyte$REACTION[!grepl("EX_",Astrocyte$ID)], compartments))==1]),"[[:blank:]]+"))),]
par(las=2,mar=c(4,35,5,5))
data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 10)
par(las=2,mar=c(4,35,5,5))
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 15)
par(las=2,mar=c(4,35,5,5))
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
dev.off()
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 15)
par(las=2,mar=c(4,35,5,5))
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 15,width = 10)
par(las=2,mar=c(4,35,5,5))
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 15,width = 10)
par(las=2,mar=c(4,30,5,5))
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 15,width = 10)
par(las=2,mar=c(4,30,5,5),cex=0.9)
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 15,width = 8)
par(las=2,mar=c(4,30,5,5),cex=0.9)
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 10,width = 15)
par(las=2,mar=c(4,30,5,5),cex=0.9)
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 12,width = 15)
par(las=2,mar=c(4,30,5,5),cex=0.9)
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 15,width = 15)
par(las=2,mar=c(4,30,5,5),cex=0.9)
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 17,width = 15)
par(las=2,mar=c(4,30,5,5),cex=0.9)
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 17,width = 11)
par(las=2,mar=c(4,30,5,5),cex=0.9)
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
par(las=2,mar=c(4,30,5,5),cex=0.9)
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 15,width = 11)
par(las=2,mar=c(4,30,5,5),cex=0.9)
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 15,width = 15)
par(las=2,mar=c(4,30,5,5),cex=0.9)
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 20,width = 15)
par(las=2,mar=c(4,30,5,5),cex=0.9)
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 15,width = 20)
par(las=2,mar=c(4,30,5,5),cex=0.9)
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 15,width = 10)
par(las=2,mar=c(4,30,5,5),cex=0.9)
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 12,width = 15)
par(las=2,mar=c(4,30,5,5),cex=0.9)
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 15,width = 15)
par(las=2,mar=c(4,30,5,5),cex=0.9)
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions",beside = TRUE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 15,width = 14)
par(las=2,mar=c(4,30,5,5),cex=0.9)
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 15,width = 13)
par(las=2,mar=c(4,30,5,5),cex=0.9)
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
pdf("Documents/thesisDocument/neuroprotective/Pathways.pdf",height = 15,width = 15)
par(las=2,mar=c(4,30,5,5),cex=0.9)
# data <- try(kegg.gsets(species = "hsa", id.type = "entrez"))
# data <- matrix(gsub("[[:digit:]]+$","",names(unlist(data$kg.sets))),dimnames = list(as.vector(unlist(data$kg.sets)),c()))
# data[,1] <- gsub("hsa[[:digit:]]+ ","",data[,1])
# genes <- unique(unlist(strsplit(gsub("\\(|or|and|\\)","",Astrocyte$GPR)," ")))
d <- sort(table(data[as.character(genes[genes%in%rownames(data)]),])/sum(table(data[as.character(genes[genes%in%rownames(data)]),]))*100,decreasing = FALSE)
barplot(d,horiz = TRUE,main = "Percentage of Reactions by Metabolic Pathway",xlab="% Reactions")
dev.off()
d
length(d)
sort(d,decreasing = TRUE)
sort(d,decreasing = TRUE)[1:10]
sum(sort(d,decreasing = TRUE)[1:10])
library(sybilSBML)
readSBMLmod("Results/Astrocyte.xml")
h <- readSBMLmod("Results/matureAstrocyte.xml")
optimizeProb(h)
0.377063*100
getFluxDist(optimizeProb(h))
table(getFluxDist(optimizeProb(h))!=0)
table(getFluxDist(optimizeProb(h))!=0)/h@react_num
round(table(getFluxDist(optimizeProb(h))!=0)/h@react_num,1)
round(table(getFluxDist(optimizeProb(h))!=0)/h@react_num,2)
