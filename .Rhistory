quantile(b,c(0.025,0.095))
quantile(b,c(0.025,0.95))
quantile(b,c(0.05,0.95))
quantile(b,c(0.025,0.975))
sdM <- function(model,R){
t0 <- optimizeProb(model)@lp_obj
set.seed(1234)
FVA <- fluxVar(model)
V <- sapply(seq_len(model@react_num), function(x){runif(n = FVA@react@react_num,min = min(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])),max = max(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])) )})
diag(V) <- getFluxDist(optimizeProb(model))
OF <- function(w){
f <- mapply(function(x,y){V[x,y]},x=w,y=seq_len(model@react_num))
model@lowbnd <- f
model@uppbnd <- f
optimizeProb(model)@lp_obj
}
b <- unlist(foreach(i=1:R) %dopar% {
OF(sample(seq_len(model@react_num)))
})
return(sd(b))
}
sdM(model,100)
sdM(model,1000)
biib
mean(b)
mean(b)-b
mean(mean(b)-b)
mean(mean(b)-b)^2
sdM <- function(model,R){
t0 <- optimizeProb(model)@lp_obj
set.seed(1234)
FVA <- fluxVar(model)
V <- sapply(seq_len(model@react_num), function(x){runif(n = FVA@react@react_num,min = min(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])),max = max(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])) )})
diag(V) <- getFluxDist(optimizeProb(model))
OF <- function(w){
f <- mapply(function(x,y){V[x,y]},x=w,y=seq_len(model@react_num))
model@lowbnd <- f
model@uppbnd <- f
optimizeProb(model)@lp_obj
}
b <- unlist(foreach(i=1:R) %dopar% {
OF(sample(seq_len(model@react_num)))
})
return(c(BIAS=mean(mean(b)-b)^2,SD=sd(b)))
}
sdM(model,1000)
data("Ec_core")
sdM(Ec_core,1000)
V <- function(model,R){
t0 <- optimizeProb(model)@lp_obj
set.seed(1234)
FVA <- fluxVar(model)
V <- sapply(seq_len(model@react_num), function(x){runif(n = FVA@react@react_num,min = min(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])),max = max(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])) )})
diag(V) <- getFluxDist(optimizeProb(model))
OF <- function(w){
f <- mapply(function(x,y){V[x,y]},x=w,y=seq_len(model@react_num))
model@lowbnd <- f
model@uppbnd <- f
optimizeProb(model)@lp_obj
}
b <- unlist(foreach(i=1:R) %dopar% {
OF(sample(seq_len(model@react_num)))
})
}
O1 <- V(model1,R)
model1 <- Ec_core
model2 <- Ec_core
O1 <- V(model1,R)
O2 <- V(model2,R)
t.test(O1,O2)
t.test(O1,O2)
tM <- function(model1,model2,R){
V <- function(model,R){
t0 <- optimizeProb(model)@lp_obj
set.seed(1234)
FVA <- fluxVar(model)
V <- sapply(seq_len(model@react_num), function(x){runif(n = FVA@react@react_num,min = min(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])),max = max(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])) )})
diag(V) <- getFluxDist(optimizeProb(model))
OF <- function(w){
f <- mapply(function(x,y){V[x,y]},x=w,y=seq_len(model@react_num))
model@lowbnd <- f
model@uppbnd <- f
optimizeProb(model)@lp_obj
}
b <- unlist(foreach(i=1:R) %dopar% {
OF(sample(seq_len(model@react_num)))
})
}
M1 <- V(model1,R)
M2 <- V(model2,R)
t.test(O1,O2)
}
healthy <- readSBMLmod("Documents/masterThesis/Results/matureAstrocyte.xml")
inflammated <- healthy
lowbnd(inflammated)
uppbnd(inflammated)[inflammated@react_id=="EX_hdca(e)"] <- -0.208
tM(healthy,inflammated,1000)
tM <- function(model1,model2,R){
V <- function(model,R){
t0 <- optimizeProb(model)@lp_obj
set.seed(1234)
FVA <- fluxVar(model)
V <- sapply(seq_len(model@react_num), function(x){runif(n = FVA@react@react_num,min = min(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])),max = max(c(FVA@lp_obj[x],FVA@lp_obj[(model@react_num+x)])) )})
diag(V) <- getFluxDist(optimizeProb(model))
OF <- function(w){
f <- mapply(function(x,y){V[x,y]},x=w,y=seq_len(model@react_num))
model@lowbnd <- f
model@uppbnd <- f
optimizeProb(model)@lp_obj
}
b <- unlist(foreach(i=1:R) %dopar% {
OF(sample(seq_len(model@react_num)))
})
}
M1 <- V(model1,R)
M2 <- V(model2,R)
t.test(M1,M2)
}
tM(healthy,inflammated,1000)
citation("sybil")
citation(minval)
citation("minval")
citation("R")
citation(R)
citation()
citation("exp2flux")
cite("glpkapi")
cite("glpkAPI")
citation("glpkAPI")
?RobAna
library(sybil)
?robAna
scan("Desktop/Taller3.tsv")
v <- scan("Desktop/Taller3.tsv")
sum(round(v,2))
mean(v)
median(v)
TiboloneReactions <- read.csv("~/Documents/masterThesis/Results/TiboloneReactions.csv", sep=";")
View(TiboloneReactions)
TiboloneReactions <- read.csv("~/Documents/masterThesis/Results/TiboloneReactions.csv", sep=";")
View(TiboloneReactions)
View(TiboloneReactions)
RECON_met <- read.delim("~/Dropbox/Maestria Bioinformatica/Tesis de Maestria/Data/RECON_met.txt")
View(RECON_met)
runif(n = 4,min = 1,max = 10)
round(runif(n = 4,min = 1,max = 10))
round(runif(n = 4,min = 1,max = 10))
write.table(round(runif(n = 4,min = 1,max = 10)),quote = FALSE)
write.table(round(runif(n = 4,min = 1,max = 10)),quote = FALSE,row.names = FALSE,col.names = FALSE,sep = "\t")
write.table(round(runif(n = 4,min = 1,max = 10)),quote = FALSE,row.names = FALSE,col.names = FALSE,sep = "\t",file = "Taller3.tsv")
write.table(round(runif(n = 4,min = 1,max = 10)),quote = FALSE,row.names = FALSE,col.names = FALSE,sep = "\t",file = "Desktop/Taller3.tsv")
write.table(round(runif(n = 4,min = 1,max = 10)),quote = FALSE,row.names = FALSE,col.names = FALSE,eol = "\t",file = "Desktop/Taller3.tsv")
write.table(runif(n = 4,min = 1,max = 10),quote = FALSE,row.names = FALSE,col.names = FALSE,eol = "\t",file = "Desktop/Taller3.tsv")
write.table(round(runif(n = 9,min = 1,max = 10)),quote = FALSE,row.names = FALSE,col.names = FALSE,eol = "\t",file = "Desktop/Taller3.tsv")
write.table(round(runif(n = 16,min = 1,max = 10)),quote = FALSE,row.names = FALSE,col.names = FALSE,eol = "\t",file = "Desktop/Taller3.tsv")
write.table(round(runif(n = 16,min = 1,max = 10)),quote = FALSE,row.names = FALSE,col.names = FALSE,eol = "\t",file = "Desktop/Taller3.tsv")
scan("Desktop/Taller3.tsv")
n <- scan("Desktop/Taller3.tsv")
sum(n)
round(n,2)
sum(round(n,2))
mean(n)
median(n)
m <- read.csv2("Desktop/Apellido1Apellido2_1.txt")
View(m)
Apellido1Apellido2_1 <- read.csv("~/Desktop/Apellido1Apellido2_1.txt", header=FALSE, sep=";")
View(Apellido1Apellido2_1)
View(Apellido1Apellido2_1)
library(g2f)
glycolysisKEGG <- read.csv("~/Documents/minval/inst/extdata/glycolysisKEGG.csv", sep=";")
View(glycolysisKEGG)
getReference(organism = "hsa",sep = ";")
Hsapiens <- getReference(organism = "hsa",sep = ";")
glycolysisKEGG$ID[10:19]
as.character(glycolysisKEGG$ID[10:19])
write.table(as.character(glycolysisKEGG$ID[10:19]),col.names = FALSE,row.names = FALSE
)
glycolysisKEGGid <- c("R00200",
"R00658",
"R01015",
"R01061",
"R01070",
"R01512",
"R01518",
"R01786",
"R02740",
"R04779")
library(minval)
sample(glycolysisKEGGid,5)
mapReactions(reactionList = sample(glycolysisKEGGid,5),referenceData = glycolysisKEGG,by = "ID")
Hsapiens$reaction[Hsapiens$id%in%sample(glycolysisKEGGid,5)]
smG <- Hsapiens$reaction[Hsapiens$id%in%sample(glycolysisKEGGid,5)]
gapFill(smG,Hsapiens$reaction)
gapFill(smG,Hsapiens$reaction)%in%glycolysisKEGG$REACTION
View(glycolysisKEGG)
KEGG <- glycolysisKEGG$REACTION[glycolysisKEGG$ID%in%glycolysisKEGGid]
smG <- Hsapiens$reaction[Hsapiens$id%in%sample(glycolysisKEGGid,5)]
gapFill(smG,Hsapiens$reaction)%in%glycolysisKEGG$REACTION
KEGG
gapFill(smG,Hsapiens$reaction)%in%KEGG
KEGG
smG%in%KEGG
KEGG <-Hsapiens$reaction[Hsapiens$id%in%glycolysisKEGGid]
smG <- Hsapiens$reaction[Hsapiens$id%in%sample(glycolysisKEGGid,5)]
gapFill(smG,Hsapiens$reaction)%in%KEGG
gapFill(smG,Hsapiens$reaction)%in%KEGG
KEGG
smG
gapFill(smG,Hsapiens$reaction)
smG <- Hsapiens$reaction[Hsapiens$id%in%sample(glycolysisKEGGid,5)]
gapFill(smG,Hsapiens$reaction)
KEGG
r <- gapFill(smG,Hsapiens$reaction)
r %in% KEGG
r %in% KEGG
r <- gapFill(smG,Hsapiens$reaction)
gapFill(smG,Hsapiens$reaction)
r %in% KEGG
r <- gapFill(smG,Hsapiens$reaction)
r %in% KEGG
RECON <- read.csv("~/Documents/masterThesis/Data/RECON.csv", sep=";")
View(RECON)
RECON$Rxn.name=="NADH2"
RECON$Rxn.name=="NADH2_u10m"
RECON$Formula[RECON$Rxn.name=="NADH2_u10m"]
RECON$Formula[RECON$Rxn.name=="r0639"]
RECON$Formula[RECON$Rxn.name=="r0653"]
RECON$Formula[RECON$Rxn.name=="r0714"]
RECON$Formula[RECON$Rxn.name=="v"]
RECON$Formula[RECON$Rxn.name=="r0716"]
RECON$Formula[RECON$Rxn.name=="r0718"]
RECON$Formula[RECON$Rxn.name=="r0720"]
RECON$Rxn.description[RECON$Rxn.name=="AKGMALtm"]
RECON$Rxn.description[RECON$Rxn.name=="NADH2\_u10m"]
RECON$Rxn.description[RECON$Rxn.name=="NADH2_u10m"]
RECON$Rxn.description[RECON$Rxn.name=="r0639"]
RECON$Rxn.description[RECON$Rxn.name=="r0653"]
RECON$Rxn.description[RECON$Rxn.name=="r0714"]
RECON$Rxn.description[RECON$Rxn.name=="r0716"]
RECON$Rxn.description[RECON$Rxn.name=="r0718"]
RECON$Rxn.description[RECON$Rxn.name=="r0720"]
RECON$Rxn.description[RECON$Rxn.name=="H2Otm"]
library(sybilSBML)
library(minval)
library(exp2flux)
matureAstrocyte_Model <- readSBMLmod("Results/matureAstrocyte.xml")
# Adding Palmitate
lowbnd(matureAstrocyte_Model)[react_id(matureAstrocyte_Model) == 'EX_hdca(e)'] <- -0.208
uppbnd(matureAstrocyte_Model)[react_id(matureAstrocyte_Model) == 'EX_hdca(e)'] <- -0.208
# ProInflamatoryReactions
healthy <- readSBMLmod("Results/matureAstrocyte.xml")
inflammated <- matureAstrocyte_Model
matureAstrocyte_Model <- readSBMLmod("Results/matureAstrocyte_Tibolone.xml")
setwd("~/Documents/masterThesis")
matureAstrocyte_Model <- readSBMLmod("Results/matureAstrocyte_Tibolone.xml")
oV <- optimizeProb(matureAstrocyte_Model)@lp_obj
E <- NULL
for(reactionID in Tibolone$ID){
lb <- lowbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID]
ub <- uppbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID]
lowbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID] <- 0
uppbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID] <- 0
E <- c(E,optimizeProb(matureAstrocyte_Model)@lp_obj)
lowbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID] <- lb
uppbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID] <- ub
}
Tibolone <- read.csv2("Results/matureTiboloneReactions.csv")
oV <- optimizeProb(matureAstrocyte_Model)@lp_obj
E <- NULL
for(reactionID in Tibolone$ID){
lb <- lowbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID]
ub <- uppbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID]
lowbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID] <- 0
uppbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID] <- 0
E <- c(E,optimizeProb(matureAstrocyte_Model)@lp_obj)
lowbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID] <- lb
uppbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID] <- ub
}
E
E<OV
E<oV
E<oV
E[E<oV]
E[E<round(oV,2)]
E[E<round(oV,3)]
round(oV,2)
round(oV,5)
E<round(oV,5)
E<round(oV,6)
E<round(oV,7)
round(E,2)
round(E,2)<oV
E[round(E,2)<oV]
Tibolone[round(E,2)<oV]
Tibolone[round(E,2)<oV,]
matureAstrocyte_Model <- read.csv2("Results/matureAstrocyte.csv")
Tibolone <- read.csv2("Results/matureTiboloneReactions.csv")
matureAstrocyte_Model <- rbind(matureAstrocyte_Model,Tibolone)
convert2sbml(matureAstrocyte_Model,"Results/matureAstrocyte_Tibolone.xml")
matureAstrocyte_Model <- readSBMLmod("Results/matureAstrocyte_Tibolone.xml")
oV <- optimizeProb(matureAstrocyte_Model)@lp_obj
E <- NULL
for(reactionID in Tibolone$ID){
lb <- lowbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID]
ub <- uppbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID]
lowbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID] <- 0
uppbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID] <- 0
E <- c(E,optimizeProb(matureAstrocyte_Model)@lp_obj)
lowbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID] <- lb
uppbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID] <- ub
}
E
plot(E)
lowbnd(matureAstrocyte_Model)[react_id(matureAstrocyte_Model) == 'EX_hdca(e)'] <- -0.208
uppbnd(matureAstrocyte_Model)[react_id(matureAstrocyte_Model) == 'EX_hdca(e)'] <- -0.208
lowbnd(matureAstrocyte_Model)[react_id(matureAstrocyte_Model) == 'EX_estradiol(e)'] <- -1
lowbnd(matureAstrocyte_Model)[react_id(matureAstrocyte_Model) == 'EX_prgstrn(e)'] <- -1
lowbnd(matureAstrocyte_Model)[react_id(matureAstrocyte_Model) == 'EX_tststerone(e)'] <- -1
lowbnd(matureAstrocyte_Model)[react_id(matureAstrocyte_Model) == 'EX_crtsl(e)'] <- -1
lowbnd(matureAstrocyte_Model)[react_id(matureAstrocyte_Model) == 'EX_aldstrn(e)'] <- -1
oV <- optimizeProb(matureAstrocyte_Model)@lp_obj
E <- NULL
for(reactionID in Tibolone$ID){
lb <- lowbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID]
ub <- uppbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID]
lowbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID] <- 0
uppbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID] <- 0
E <- c(E,optimizeProb(matureAstrocyte_Model)@lp_obj)
lowbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID] <- lb
uppbnd(matureAstrocyte_Model)[matureAstrocyte_Model@react_id==reactionID] <- ub
}
plot(E)
round(E,2)
round(E,2)>oV
round(E,2)<oV
Tibolone[round(E,2)<oV,]
Tibolone[round(E,2)<oV & GPR!="",]
Tibolone[round(E,2)<oV & Tibolone$GPR!="",]
View(RECON)
AGenes <- read.csv("~/Desktop/AGenes.txt", sep="")
View(AGenes)
AGenes$ENTREZ_GENE=="124"
AGenes[AGenes$ENTREZ_GENE=="124",]
is.na(AGenes)
complete.cases(AGenes)
AGenes[complete.cases(AGenes),]
AGenes <- AGenes[complete.cases(AGenes),]
View(AGenes)
View(Tibolone)
matureAstrocyte_Model@react_id=="RE1804M"
getFluxDist(optimizeProb(matureAstrocyte_Model))[matureAstrocyte_Model@react_id=="RE1804M"]
getFluxDist(optimizeProb(matureAstrocyte_Model))[matureAstrocyte_Model@react_id=="RE1807M"]
RECON_met <- read.delim("~/Dropbox/Maestria Bioinformatica/Tesis de Maestria/Data/RECON_met.txt")
View(RECON_met)
AGenes <- read.csv("~/Desktop/AGenes.txt", sep="")
View(AGenes)
Astrocyte_Expression <- as.matrix(read.csv(file = "Data/GSE73721/GSE73721_Human_and_mouse_table.csv.gz",
header = TRUE,row.names = "Gene")[,c(9:26)])
View(Astrocyte_Expression)
rownames(Astrocyte_Expression)=="Cyp27a1"
table(rownames(Astrocyte_Expression)=="Cyp27a1")
Astrocyte_Expression[rownames(Astrocyte_Expression)=="Cyp27a1",]
getFluxDist(optimizeProb(matureAstrocyte_Model))[matureAstrocyte_Model@react_id=="r0739"]
round(getFluxDist(optimizeProb(matureAstrocyte_Model))[matureAstrocyte_Model@react_id=="r0739"],2)
round(getFluxDist(optimizeProb(matureAstrocyte_Model))[matureAstrocyte_Model@react_id=="r2518"],2)
round(getFluxDist(optimizeProb(matureAstrocyte_Model))[matureAstrocyte_Model@react_id=="RE1804M"],2)
rownames(Astrocyte_Expression)
grep("ADH",rownames(Astrocyte_Expression),ignore.case = TRUE)
Astrocyte_Expression[grep("ADH",rownames(Astrocyte_Expression),ignore.case = TRUE),]
Astrocyte_Expression[grep("abcd3",rownames(Astrocyte_Expression),ignore.case = TRUE),]
Astrocyte_Expression[grep("cyp27a1",rownames(Astrocyte_Expression),ignore.case = TRUE),]
barplot(Astrocyte_Expression[grep("cyp27a1",rownames(Astrocyte_Expression),ignore.case = TRUE),])
healthy <- readSBMLmod("Results/matureAstrocyte.xml")
model_FBA <- optimizeProb(healty)
model_MTF <- optimizeProb(healty, algorithm = "mtf", wtobj = mod_obj(model_FBA))
h <- getNetFlux(getFluxDist(model_MTF,findExchReact(healty)))
inflammated <- healthy
lowbnd(inflammated)[inflammated@react_id=="EX_hdca(e)"] <- -0.208
uppbnd(inflammated)[inflammated@react_id=="EX_hdca(e)"] <- -0.208
model_FBA <- optimizeProb(inflammated)
model_MTF <- optimizeProb(inflammated, algorithm = "mtf", wtobj = mod_obj(model_FBA))
i <- getNetFlux(getFluxDist(model_MTF,findExchReact(inflammated)))
medicated <- readSBMLmod("Results/matureAstrocyte_Tibolone.xml")
lowbnd(medicated)[medicated@react_id=="EX_hdca(e)"] <- -0.208
uppbnd(medicated)[medicated@react_id=="EX_hdca(e)"] <- -0.208
model_FBA <- optimizeProb(medicated)
model_MTF <- optimizeProb(medicated, algorithm = "mtf", wtobj = mod_obj(model_FBA))
m <- getNetFlux(getFluxDist(model_MTF,findExchReact(medicated)))
h <- cbind(h@react_id,h@rate)
i <- cbind(i@react_id,i@rate)
m <- cbind(m@react_id,m@rate)
inputs <- merge(merge(m,i,by="V1"),h,by="V1")
inputs <- as.matrix(inputs[,2:4])
healthy <- readSBMLmod("Results/matureAstrocyte.xml")
model_FBA <- optimizeProb(healty)
model_FBA <- optimizeProb(healthy)
model_MTF <- optimizeProb(healthy, algorithm = "mtf", wtobj = mod_obj(model_FBA))
h <- getNetFlux(getFluxDist(model_MTF,findExchReact(healthy)))
inflammated <- healthy
lowbnd(inflammated)[inflammated@react_id=="EX_hdca(e)"] <- -0.208
uppbnd(inflammated)[inflammated@react_id=="EX_hdca(e)"] <- -0.208
model_FBA <- optimizeProb(inflammated)
model_MTF <- optimizeProb(inflammated, algorithm = "mtf", wtobj = mod_obj(model_FBA))
i <- getNetFlux(getFluxDist(model_MTF,findExchReact(inflammated)))
medicated <- readSBMLmod("Results/matureAstrocyte_Tibolone.xml")
lowbnd(medicated)[medicated@react_id=="EX_hdca(e)"] <- -0.208
uppbnd(medicated)[medicated@react_id=="EX_hdca(e)"] <- -0.208
model_FBA <- optimizeProb(medicated)
model_MTF <- optimizeProb(medicated, algorithm = "mtf", wtobj = mod_obj(model_FBA))
m <- getNetFlux(getFluxDist(model_MTF,findExchReact(medicated)))
h <- cbind(h@react_id,h@rate)
i <- cbind(i@react_id,i@rate)
m <- cbind(m@react_id,m@rate)
inputs <- merge(merge(m,i,by="V1"),h,by="V1")
inputs <- as.matrix(inputs[,2:4])
View(inputs)
inputs <- merge(merge(m,i,by="V1"),h,by="V1")
View(inputs)
matureAstrocyte_Model <- readSBMLmod("Results/matureAstrocyte.xml")
# Adding Palmitate
lowbnd(matureAstrocyte_Model)[react_id(matureAstrocyte_Model) == 'EX_hdca(e)'] <- -0.208
uppbnd(matureAstrocyte_Model)[react_id(matureAstrocyte_Model) == 'EX_hdca(e)'] <- -0.208
# ProInflamatoryReactions
healthy <- readSBMLmod("Results/matureAstrocyte.xml")
inflammated <- matureAstrocyte_Model
fD <- fluxDifferences(healthy,inflammated,0)
fD <- fD[fD[,3]!=0,]
GPR <- NULL
for (i in rownames(fD)){
GPR <- c(GPR,healthy@gpr[healthy@react_id%in%i])
}
fD <- fD[nchar(GPR)>0,]
OF <- NULL
for(reaction in rownames(fD)){
lb <- lowbnd(inflammated)[react_id(inflammated) == reaction]
ub <- uppbnd(inflammated)[react_id(inflammated) == reaction]
lowbnd(inflammated)[react_id(inflammated) == reaction] <- 0
uppbnd(inflammated)[react_id(inflammated) == reaction] <- 0
OF <- c(OF,optimizeProb(inflammated)@lp_obj)
lowbnd(inflammated)[react_id(inflammated) == reaction] <- lb
uppbnd(inflammated)[react_id(inflammated) == reaction] <- ub
}
fD[OF>round(optimizeProb(inflammated)@lp_obj,2),]
OF
OFplot(OF)
plot(OF,type"h")
plot(OF,type="h")
fD[OF>round(optimizeProb(inflammated)@lp_obj,2),]
[OF>round(optimizeProb(inflammated)@lp_obj,2)
[OF>round(optimizeProb(inflammated)@lp_obj,2)]
OF[OF>round(optimizeProb(inflammated)@lp_obj,2)]
OF[OF>round(optimizeProb(inflammated)@lp_obj,2)]-optimizeProb(inflammated)@lp_obj
(OF[OF>round(optimizeProb(inflammated)@lp_obj,2)]-optimizeProb(inflammated)@lp_obj)/optimizeProb(inflammated)@lp_obj
((OF[OF>round(optimizeProb(inflammated)@lp_obj,2)]-optimizeProb(inflammated)@lp_obj)/optimizeProb(inflammated)@lp_obj*100
)
((OF[OF>round(optimizeProb(inflammated)@lp_obj,2)]-optimizeProb(inflammated)@lp_obj)/optimizeProb(inflammated)@lp_obj*100)
round(((OF[OF>round(optimizeProb(inflammated)@lp_obj,2)]-optimizeProb(inflammated)@lp_obj)/optimizeProb(inflammated)@lp_obj*100),2)
pdf(file = "Slides/Figures/Effects.pdf",width = 10,height = 4,encoding = 'ISOLatin2.enc')
par(mfcol=c(1,6),las=2,mar=c(7,3,4,3))
barplot(c(Healthy=0.377,Inflammated=0.318,Tibolone=0.427),col=c("darkblue","red","dodgerblue2"),main="BIOMASS\nDMEM medium")
barplot(c(Healthy=4.652,Inflammated=1.893,Tibolone=1.893),col=c("darkblue","red","dodgerblue2"),main="CYS[e] to GTHRD[e]\nConversion")
barplot(c(Healthy=1.813,Inflammated=0.507,Tibolone=0.507),col=c("darkblue","red","dodgerblue2"),main="GLC[e] to ATP[e]\nConversion")
barplot(c(Healthy=1.792,Inflammated=0.458,Tibolone=0.458),col=c("darkblue","red","dodgerblue2"),main="GLC[e] to LACTATE[e]\nConversion")
barplot(c(Healthy=3.185,Inflammated=1.029,Tibolone=1.029),col=c("darkblue","red","dodgerblue2"),main="GLU[e] to GLN[e]\nConversion")
barplot(c(Healthy=1000.377,Inflammated=1000.377,Tibolone=1000.377),col=c("darkblue","red","dodgerblue2"),main="GLY[e] to dSER[e]\nConversion")
dev.off()
healthy <- readSBMLmod("Results/matureAstrocyte.xml")
model_FBA <- optimizeProb(healthy)
model_MTF <- optimizeProb(healthy, algorithm = "mtf", wtobj = mod_obj(model_FBA))
h <- getNetFlux(getFluxDist(model_MTF,findExchReact(healthy)))
inflammated <- healthy
lowbnd(inflammated)[inflammated@react_id=="EX_hdca(e)"] <- -0.208
uppbnd(inflammated)[inflammated@react_id=="EX_hdca(e)"] <- -0.208
getFluxDist(optimizeProb(inflammated))
getFluxDist(optimizeProb(inflammated))!=0
table(getFluxDist(optimizeProb(inflammated))!=0)
table(getFluxDist(optimizeProb(inflammated))!=0)/inflammated@react_num
round(table(getFluxDist(optimizeProb(inflammated))!=0)/inflammated@react_num,2)
round(table(getFluxDist(optimizeProb(inflammated))!=0)/inflammated@react_num*100,2)
round(table(getFluxDist(optimizeProb(inflammated))!=0)/inflammated@react_num*100,1)
a <- fluxDifferences(healthy,inflammated,0)
View(a)
a[,3]
a[,3]!=0
table(a[,3]!=0)
RECON <- read.csv("~/Documents/masterThesis/Data/RECON.csv", sep=";")
View(RECON)
(0.427-0.377)/0.377
((0.427-0.377)/0.377)*1''
((0.427-0.377)/0.377)*100
round((0.427-0.377)/0.377)*100,2)
round(((0.427-0.377)/0.377)*100,2)
pdf(file = "Slides/Figures/Effects.pdf",width = 10,height = 4,encoding = 'ISOLatin2.enc')
par(mfcol=c(1,6),las=2,mar=c(7,3,4,3))
barplot(c(Healthy=0.377,Inflammated=0.318,Tibolone=0.427),col=c("darkblue","red","dodgerblue2"),main="BIOMASS\nDMEM medium",ylab="Objective Function Value")
barplot(c(Healthy=4.652,Inflammated=1.893,Tibolone=1.893),col=c("darkblue","red","dodgerblue2"),main="CYS[e] to GTHRD[e]\nConversion")
barplot(c(Healthy=1.813,Inflammated=0.507,Tibolone=0.507),col=c("darkblue","red","dodgerblue2"),main="GLC[e] to ATP[e]\nConversion")
barplot(c(Healthy=1.792,Inflammated=0.458,Tibolone=0.458),col=c("darkblue","red","dodgerblue2"),main="GLC[e] to LACTATE[e]\nConversion")
barplot(c(Healthy=3.185,Inflammated=1.029,Tibolone=1.029),col=c("darkblue","red","dodgerblue2"),main="GLU[e] to GLN[e]\nConversion")
barplot(c(Healthy=1000.377,Inflammated=1000.377,Tibolone=1000.377),col=c("darkblue","red","dodgerblue2"),main="GLY[e] to dSER[e]\nConversion")
dev.off()
dev.off()
dev.off()
pdf(file = "Slides/Figures/Effects.pdf",width = 10,height = 4,encoding = 'ISOLatin2.enc')
par(mfcol=c(1,6),las=2,mar=c(7,3,4,3))
barplot(c(Healthy=0.377,Inflammated=0.318,Tibolone=0.427),col=c("darkblue","red","dodgerblue2"),main="BIOMASS\nDMEM medium",ylab="Objective Function Value")
barplot(c(Healthy=4.652,Inflammated=1.893,Tibolone=1.893),col=c("darkblue","red","dodgerblue2"),main="CYS[e] to GTHRD[e]\nConversion")
barplot(c(Healthy=1.813,Inflammated=0.507,Tibolone=0.507),col=c("darkblue","red","dodgerblue2"),main="GLC[e] to ATP[e]\nConversion")
barplot(c(Healthy=1.792,Inflammated=0.458,Tibolone=0.458),col=c("darkblue","red","dodgerblue2"),main="GLC[e] to LACTATE[e]\nConversion")
barplot(c(Healthy=3.185,Inflammated=1.029,Tibolone=1.029),col=c("darkblue","red","dodgerblue2"),main="GLU[e] to GLN[e]\nConversion")
barplot(c(Healthy=1000.377,Inflammated=1000.377,Tibolone=1000.377),col=c("darkblue","red","dodgerblue2"),main="GLY[e] to dSER[e]\nConversion")
dev.off()
